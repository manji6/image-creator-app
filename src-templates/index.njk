---
layout: layouts/base.njk
title: Image Creator
description: ローカルファーストで複数プロンプトの画像を一括生成できるWebアプリ
activeNav: index
headerSubtitle: Local-First Image Ops
headerTitle: Image Creator
headerDescription: 簡単に画像生成APIを実行するWebアプリです。
hasHeaderActions: true
showFooter: false
stylesPath: ./styles.css
includeJSZip: true
includeMainJS: true
---

<section class="grid gap-4 lg:grid-cols-[400px_minmax(0,1fr)]">
  <aside class="space-y-4">
    <article class="rounded-3xl border border-white/60 bg-white/85 p-5 shadow-card backdrop-blur-md">
      <h2 class="font-heading text-lg font-bold text-slateBrand">プロバイダー選択</h2>
      <div class="mt-3 space-y-2">
        <label>
          <input type="radio" name="providerRadio" value="fal" checked />
          <span class="ml-2 text-sm font-semibold text-slate-700">fal.ai</span>
        </label>
        <label>
          <input type="radio" name="providerRadio" value="google" />
          <span class="ml-2 text-sm font-semibold text-slate-700">Google AI Studio</span>
        </label>
        <label>
          <input type="radio" name="providerRadio" value="firefly" />
          <span class="ml-2 text-sm font-semibold text-slate-700">Adobe Firefly</span>
        </label>
      </div>
    </article>

    <article class="rounded-3xl border border-white/60 bg-white/85 p-5 shadow-card backdrop-blur-md">
      <h2 class="font-heading text-lg font-bold text-slateBrand">モデル選択</h2>
      <div class="mt-3 flex items-center gap-2">
        <input
          id="modelInput"
          type="text"
          class="flex-1 rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none"
          placeholder="モデル名を選択または入力"
          autocomplete="off"
        />
        <button
          id="refreshModelsButton"
          type="button"
          class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:border-sea hover:text-sea"
        >
          一覧を更新
        </button>
      </div>
      <div id="modelDropdown" class="relative mt-2 hidden max-h-64 overflow-auto rounded-xl border border-slate-200 bg-white shadow-soft">
        <div id="modelList"></div>
      </div>

      <div id="referenceImageSection" class="mt-4 hidden rounded-2xl border border-emerald-200 bg-emerald-50/70 p-4">
        <h3 class="text-sm font-semibold text-emerald-800">参照画像 (任意)</h3>
        <p class="mt-1 text-xs text-emerald-700">このモデルは参照画像をサポートします。以下から画像を選択してください。</p>
        <div class="mt-3">
          <label class="block cursor-pointer rounded-lg border-2 border-dashed border-emerald-300 bg-white px-3 py-4 text-center text-sm font-semibold text-emerald-600 transition hover:border-emerald-400 hover:bg-emerald-50">
            ファイルを選択
            <input id="referenceImageInput" type="file" accept="image/png,image/jpeg,image/jpg,image/webp" class="hidden" />
          </label>
        </div>
        <div id="referenceImagePreviewWrap" class="hidden rounded-xl border border-emerald-200 bg-white p-2">
          <img id="referenceImagePreview" class="h-28 w-full rounded-lg object-cover" alt="Reference image preview" />
          <p id="referenceImageMeta" class="mt-2 text-xs text-slate-600"></p>
        </div>
        <p id="referenceImageValidationMessage" class="hidden rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700"></p>
      </div>

      <div class="mt-4 space-y-4">
        <div>
          <label class="block text-sm font-semibold text-slate-700" for="modeSelect">プロンプトモード</label>
          <select id="modeSelect" class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sea focus:outline-none">
            <option value="light">Light Mode</option>
            <option value="advanced">Advanced Mode</option>
          </select>
          <p id="modeHint" class="mt-2 text-xs text-slate-500"></p>
        </div>

        <div>
          <label for="commonPromptInput" class="block text-sm font-semibold text-slate-700">共通プロンプト</label>
          <textarea
            id="commonPromptInput"
            rows="4"
            class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sea focus:outline-none"
            placeholder="画風・色味・構図などの共通条件"
          ></textarea>
          <p id="templateValidationMessage" class="mt-2 hidden rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700"></p>
        </div>

        <details class="group rounded-2xl border border-slate-200 bg-slate-50/70 p-3">
          <summary class="cursor-pointer list-none text-sm font-semibold text-slate-700">
            API設定 (ローカル保存)
          </summary>
          <div class="mt-3 space-y-3">
            <div>
              <label class="block text-xs font-semibold text-slate-600" for="falApiKeyInput">fal.ai API Key</label>
              <input id="falApiKeyInput" type="password" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" placeholder="FAL_KEY..." />
            </div>
            <div>
              <label class="block text-xs font-semibold text-slate-600" for="googleApiKeyInput">Google API Key</label>
              <input id="googleApiKeyInput" type="password" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" placeholder="AIza..." />
            </div>
            <div class="rounded-xl border border-amber-200 bg-amber-50/70 p-3">
              <p class="text-xs font-semibold text-amber-800">Firefly 直接接続 (推奨: セッション運用)</p>
              <p class="mt-1 text-xs text-amber-700">
                Client ID と Access Token を手動入力すると、Proxyなしで直接実行できます。
                Access Tokenは「設定を保存」しても永続化されません。
              </p>
              <div class="mt-3 space-y-3">
                <div>
                  <label class="block text-xs font-semibold text-slate-600" for="fireflyClientIdInput">Firefly Client ID</label>
                  <input id="fireflyClientIdInput" type="text" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" placeholder="Adobe Client ID" />
                </div>
                <div>
                  <label class="block text-xs font-semibold text-slate-600" for="fireflyAccessTokenInput">Firefly Access Token (Session only)</label>
                  <input id="fireflyAccessTokenInput" type="password" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" placeholder="eyJ..." />
                </div>
                <div>
                  <label class="block text-xs font-semibold text-slate-600" for="fireflyApiBaseInput">Firefly API Base (任意)</label>
                  <input id="fireflyApiBaseInput" type="url" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" placeholder="https://firefly-api.adobe.io" />
                </div>
                <div>
                  <label class="block text-xs font-semibold text-slate-600" for="fireflyContentClassInput">Firefly Content Class (任意)</label>
                  <select id="fireflyContentClassInput" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none">
                    <option value="photo">Photo (写真的な画像)</option>
                    <option value="art">Art (芸術的な画像)</option>
                  </select>
                  <p class="mt-1 text-xs text-slate-500">生成画像の特性を指定します。Photoは写真的、Artは芸術的な仕上がりになります。</p>
                </div>
              </div>
            </div>
          </div>
        </details>
      </div>
    </article>

    <article class="rounded-3xl border border-white/60 bg-white/85 p-5 shadow-card backdrop-blur-md">
      <h2 class="font-heading text-lg font-bold text-slateBrand">一括入力</h2>
      <label class="mt-3 block text-sm font-semibold text-slate-700" for="promptBatchInput">1行ごとに1プロンプト</label>
      <textarea
        id="promptBatchInput"
        rows="10"
        class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sea focus:outline-none"
        placeholder="夕暮れの東京の町並み、映画的な光&#10;手書きアニメ風の猫、柔らかい色調"
      ></textarea>
      <div class="mt-4">
        <button
          id="createCardsButton"
          type="button"
          class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-soft transition hover:border-sea hover:text-sea"
        >
          カードを作成
        </button>
      </div>
    </article>
  </aside>

  <section class="space-y-4">
    <div class="rounded-3xl border border-white/60 bg-white/85 p-4 shadow-card backdrop-blur-md">
      <div class="flex flex-wrap items-center gap-3">
        <button
          id="generateExistingButton"
          type="button"
          class="rounded-xl bg-slate-800 px-4 py-2 text-sm font-semibold text-white transition hover:bg-slate-900 disabled:cursor-not-allowed disabled:bg-slate-400"
        >
          カードを全て生成
        </button>
        <button
          id="regenerateFailedButton"
          type="button"
          class="rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-semibold text-slate-700 transition hover:border-sea hover:text-sea disabled:cursor-not-allowed disabled:text-slate-400"
        >
          失敗カードを再生成
        </button>
        <button
          id="downloadAllButton"
          type="button"
          class="rounded-xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700 disabled:cursor-not-allowed disabled:bg-slate-400"
        >
          全カードを一括DL
        </button>
      </div>
      <p class="mt-2 text-xs text-slate-500">右側から一括実行・一括DLできます。PNGは可能な場合のみプロンプトMetadataを埋め込みます。</p>
    </div>

    <div class="rounded-3xl border border-white/60 bg-white/85 p-4 shadow-card backdrop-blur-md">
      <div class="flex flex-wrap items-center gap-3">
        <span class="rounded-full bg-slate-900 px-3 py-1 text-xs font-semibold text-white" id="statusSummary">Ready</span>
        <span class="text-xs text-slate-500" id="localOnlyIndicator">Storage: Browser IndexedDB only</span>
      </div>
      <p id="globalMessage" class="mt-3 hidden rounded-xl border px-3 py-2 text-sm"></p>
    </div>

    <div id="cardsGrid" class="grid gap-4 md:grid-cols-2 2xl:grid-cols-3"></div>
  </section>
</section>

<template id="cardTemplate">
  <article class="card rounded-3xl border border-slate-200 bg-white p-4 shadow-soft transition">
    <div class="card-top relative overflow-hidden rounded-2xl bg-slate-100">
      <img class="card-image h-60 w-full object-cover" alt="Generated image" loading="lazy" />
      <div class="card-placeholder absolute inset-0 flex flex-col items-center justify-center gap-3 text-slate-500">
        <div class="loader hidden h-10 w-10 animate-spin rounded-full border-4 border-slate-300 border-t-sea"></div>
        <p class="placeholder-text text-sm font-semibold">生成待ち</p>
      </div>
    </div>

    <div class="mt-3">
      <div class="flex items-center justify-between gap-2">
        <p class="card-provider text-xs font-semibold uppercase tracking-[0.12em] text-slate-500"></p>
        <span class="card-status rounded-full px-2 py-1 text-xs font-semibold"></span>
      </div>

      <label class="mt-3 block text-xs font-semibold text-slate-500">プロンプト</label>
      <textarea class="card-prompt mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:border-sea focus:outline-none" rows="3"></textarea>

      <p class="card-error mt-2 hidden rounded-lg border border-coral/30 bg-coral/5 px-2 py-1 text-xs text-coral"></p>

      <div class="card-actions mt-3 flex items-center gap-2 opacity-100">
        <button type="button" class="card-regenerate inline-flex items-center justify-center rounded-lg bg-blue-600 px-3 py-2 text-xs font-semibold text-white transition hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400">再生成</button>
        <button type="button" class="card-preview inline-flex items-center justify-center rounded-lg border border-blue-200 bg-white px-3 py-2 text-xs font-semibold text-blue-700 transition hover:border-blue-400 hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-300">プロンプトプレビュー</button>
        <button type="button" class="card-download inline-flex items-center justify-center rounded-lg bg-emerald-600 px-3 py-2 text-xs font-semibold text-white transition hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400">DL</button>
        <button type="button" class="card-remove inline-flex items-center justify-center rounded-lg border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 transition hover:border-coral hover:text-coral">削除</button>
      </div>
    </div>
  </article>
</template>

<div id="previewModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-900/45 px-4">
  <div class="w-full max-w-3xl rounded-2xl border border-slate-200 bg-white p-4 shadow-card">
    <div class="flex items-center justify-between gap-3">
      <h3 class="font-heading text-lg font-bold text-slateBrand">プロンプトプレビュー</h3>
      <button
        id="closePreviewModalButton"
        type="button"
        class="rounded-lg border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-700 transition hover:border-slate-500"
      >
        閉じる
      </button>
    </div>
    <p id="previewModalHint" class="mt-2 text-xs text-slate-500"></p>
    <pre id="previewModalContent" class="mt-3 max-h-[60vh] overflow-auto rounded-xl border border-slate-200 bg-slate-50 p-3 text-xs leading-6 text-slate-700"></pre>
    <div class="mt-3 flex items-center justify-end gap-2">
      <button
        id="copyPreviewButton"
        type="button"
        class="rounded-lg bg-slate-800 px-3 py-2 text-xs font-semibold text-white transition hover:bg-slate-900"
      >
        コピー
      </button>
    </div>
  </div>
</div>

<div id="imagePreviewModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/90 p-3">
  <div class="relative flex h-full w-full max-w-[1600px] flex-col items-center justify-center gap-4">
    <button
      id="closeImagePreviewModalButton"
      type="button"
      class="absolute right-2 top-2 z-10 rounded-lg border border-white/30 bg-slate-900/70 px-3 py-1 text-xs font-semibold text-white transition hover:border-white/60"
    >
      閉じる
    </button>
    <div class="flex max-h-[80%] w-full items-center justify-center">
      <img
        id="imagePreviewModalImage"
        alt="Generated image full preview"
        class="max-h-full max-w-full rounded-xl object-contain shadow-card"
      />
    </div>
    <div id="imagePreviewPromptSection" class="w-full max-w-3xl rounded-2xl border border-white/20 bg-slate-900/80 p-4 backdrop-blur-md">
      <h3 class="text-xs font-semibold uppercase tracking-[0.12em] text-slate-300">生成時のプロンプト</h3>
      <pre id="imagePreviewPromptContent" class="mt-2 max-h-32 overflow-auto rounded-lg bg-slate-950/60 p-3 text-sm leading-6 text-slate-100"></pre>
    </div>
  </div>
</div>
